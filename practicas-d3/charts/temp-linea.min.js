/**
 * Created by campitos on 26/11/14.
 *//* Primero cargamos los datos de campitos-ley */angular.module("exampleApp",["ngResource"]).controller("ctrlExample",function(e,t,n){e.temperaturas=[],e.horitatemper=null,e.horita=null;var r=n("http://campitos-ley.whelastic.net/uv/servicios/estacion/temperatura",{id:"@id"},{creadito:{method:"POST"},salvate:{method:"PUT"}}),s=r.query(function(){function d(e){var t=d3.svg.axis().scale(f.range([0,E()])).ticks(24).orient("bottom"),n=d3.svg.axis().scale(l.range([S(),0])).orient("left"),i=new Date,s=i.getHours(),u=E()/24*s;e.append("g").attr("class","axis").attr("transform",function(){return"translate("+g()+","+b()+")"}).call(t).append("text").attr("x",E()).attr("dy","-0.5em").style("text-anchor","end").text("Hora del día (24 hrs.)"),d3.selectAll("g.axis g.tick").append("line").classed("grid-line",!0).attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",-(r-2*o)),e.append("g").attr("class","axis").attr("transform",function(){return"translate("+g()+","+w()+")"}).call(n).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Temperatura (ºC)"),d3.selectAll("g.axis g.tick").append("line").classed("grid-line",!0).attr("x1",0).attr("y1",0).attr("x2",E()).attr("y2",0)}function v(e){t.forEach(function(t){e.append("g").selectAll("circle").data(t).enter().append("circle").attr("class","dot").attr("cx",function(e){return f(e.hora)}).attr("cy",function(e){return l(e.temperatura)}).attr("r",4.5)})}function m(e){t.forEach(function(t){e.append("g").selectAll("circle").data(t).enter().append("circle").filter(function(e){return e.hora==a}).attr("class","dot").attr("cx",function(e){return f(e.hora)}).attr("cy",function(e){return l(e.temperatura)}).attr("r",5.5)})}function g(){return o}function y(){return n-o}function b(){return r-o}function w(){return o}function E(){return n-o*2}function S(){return r-o*2}console.log("tamano:"+s.length);var t=[s],n=780,r=500,o=30,u=new Date,a=u.getHours(),f=d3.scale.linear().domain([0,23]).range([o,n-o]),l=d3.scale.linear().domain([2,28]).range([r-o,o]),c=d3.svg.line().interpolate("monotone").x(function(e){return f(e.hora)}).y(function(e){return l(e.temperatura)}),h=d3.select("div.grafica-temp-linea").append("svg");h.attr("width",n).attr("height",r),h.selectAll("path").data(t).enter().append("path").attr("class","line").attr("d",function(e){return c(e)}),m(h),d(h);for(i=0;i<s.length;i++){var u=new Date,a=u.getHours(),p=u.getMinutes();s[i].hora===a&&(e.horitatemper=s[i].temperatura,e.horita=a+":"+p,console.log(e.horitatemper+" a la hora "+e.horita)),t[i]=s[i].temperatura}})});