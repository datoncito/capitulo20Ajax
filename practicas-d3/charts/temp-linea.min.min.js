/**
 * Created by campitos on 26/11/14.
 *//* Primero cargamos los datos de campitos-ley */angular.module("exampleApp",["ngResource"]).controller("ctrlExample",function(e,t,n){e.temperaturas=[],e.horitatemper=null,e.horita=null;var r=n("http://campitos-ley.whelastic.net/uv/servicios/estacion/temperatura",{id:"@id"},{creadito:{method:"POST"},salvate:{method:"PUT"}}),s=r.query(function(){function t(e){var t=d3.svg.axis().scale(y.range([0,l()])).ticks(24).orient("bottom"),n=d3.svg.axis().scale(b.range([c(),0])).orient("left"),r=new Date,i=r.getHours(),s=l()/24*i;e.append("g").attr("class","axis").attr("transform",function(){return"translate("+o()+","+a()+")"}).call(t).append("text").attr("x",l()).attr("dy","-0.5em").style("text-anchor","end").text("Hora del día (24 hrs.)"),d3.selectAll("g.axis g.tick").append("line").classed("grid-line",!0).attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",-(d-2*v)),e.append("g").attr("class","axis").attr("transform",function(){return"translate("+o()+","+f()+")"}).call(n).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Temperatura (ºC)"),d3.selectAll("g.axis g.tick").append("line").classed("grid-line",!0).attr("x1",0).attr("y1",0).attr("x2",l()).attr("y2",0)}function n(e){h.forEach(function(t){e.append("g").selectAll("circle").data(t).enter().append("circle").attr("class","dot").attr("cx",function(e){return y(e.hora)}).attr("cy",function(e){return b(e.temperatura)}).attr("r",4.5)})}function r(e){h.forEach(function(t){e.append("g").selectAll("circle").data(t).enter().append("circle").filter(function(e){return e.hora==g}).attr("class","dot").attr("cx",function(e){return y(e.hora)}).attr("cy",function(e){return b(e.temperatura)}).attr("r",5.5)})}function o(){return v}function u(){return p-v}function a(){return d-v}function f(){return v}function l(){return p-v*2}function c(){return d-v*2}console.log("tamano:"+s.length);var h=[s],p=780,d=500,v=30,m=new Date,g=m.getHours(),y=d3.scale.linear().domain([0,23]).range([v,p-v]),b=d3.scale.linear().domain([2,28]).range([d-v,v]),w=d3.svg.line().interpolate("monotone").x(function(e){return y(e.hora)}).y(function(e){return b(e.temperatura)}),E=d3.select("div.grafica-temp-linea").append("svg");E.attr("width",p).attr("height",d),E.selectAll("path").data(h).enter().append("path").attr("class","line").attr("d",function(e){return w(e)}),r(E),t(E);for(i=0;i<s.length;i++){var m=new Date,g=m.getHours(),S=m.getMinutes();s[i].hora===g&&(e.horitatemper=s[i].temperatura,e.horita=g+":"+S,console.log(e.horitatemper+" a la hora "+e.horita)),h[i]=s[i].temperatura}})});